>option timing 1
>option locking 1
>option semaphore 1
>proxy ./proxy
Proxy set up at bambooshark.ics.cs.cmu.edu:9437
>option stretch 200
>source '/afs/andrew.cmu.edu/usr3/yizhez/private/proxylab-s20-zhaoyizhe312/tests/C09-mix3.cmd'
># Test ability to handle mix of requests and fetches, with missing and present binary and text files
>serve s1 s2 s3
Server s1 running at bambooshark.ics.cs.cmu.edu:9385
Server s2 running at bambooshark.ics.cs.cmu.edu:14183
Server s3 running at bambooshark.ics.cs.cmu.edu:20681
>generate random-text1.txt 10k
>generate random-binary1.bin 10k
>generate random-text2.txt 100k
>generate random-binary2.bin 100k
>generate random-text3.txt 1m
>generate random-binary3.bin 1m
>request r1 random-text1.txt s1
Client: Requesting '/random-text1.txt' from bambooshark.ics.cs.cmu.edu:9385
>request r2 random-binary2.bin s2
Client: Requesting '/random-binary2.bin' from bambooshark.ics.cs.cmu.edu:14183
>request r3 random-text2.txt s1
Client: Requesting '/random-text2.txt' from bambooshark.ics.cs.cmu.edu:9385
>request r4 random-binary2.bin s3
Client: Requesting '/random-binary2.bin' from bambooshark.ics.cs.cmu.edu:20681
>request r5 random-text3.txt s3
Client: Requesting '/random-text3.txt' from bambooshark.ics.cs.cmu.edu:20681
>request r6 random-binary3.bin s2
Client: Requesting '/random-binary3.bin' from bambooshark.ics.cs.cmu.edu:14183
>request r7 nothing1.txt s1
Client: Requesting '/nothing1.txt' from bambooshark.ics.cs.cmu.edu:9385
>request r8 nothing1.txt s2
Client: Requesting '/nothing1.txt' from bambooshark.ics.cs.cmu.edu:14183
>request r9 nothing1.txt s3
Client: Requesting '/nothing1.txt' from bambooshark.ics.cs.cmu.edu:20681
>wait *
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-text1.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:9385
Proxy stderr: Request-ID: r1
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-binary2.bin HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:14183
Proxy stderr: Request-ID: r2
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-text2.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:9385
Proxy stderr: Request-ID: r3
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-binary2.bin HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:20681
Proxy stderr: Request-ID: r4
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-text3.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:20681
Proxy stderr: Request-ID: r5
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-binary3.bin HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:14183
Proxy stderr: Request-ID: r6
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /nothing1.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:9385
Proxy stderr: Request-ID: r7
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /nothing1.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:14183
Proxy stderr: Request-ID: r8
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /nothing1.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:20681
Proxy stderr: Request-ID: r9
Proxy stderr: Response: Deferred
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
># These won't hit cache, since have not yet responded
>fetch f1 random-text1.txt s1
Client: Fetching '/random-text1.txt' from bambooshark.ics.cs.cmu.edu:9385
>fetch f2 random-binary2.bin s2
Client: Fetching '/random-binary2.bin' from bambooshark.ics.cs.cmu.edu:14183
>fetch f3 random-text2.txt s1
Client: Fetching '/random-text2.txt' from bambooshark.ics.cs.cmu.edu:9385
>fetch f4 random-binary2.bin s3
Client: Fetching '/random-binary2.bin' from bambooshark.ics.cs.cmu.edu:20681
>fetch f5 random-text3.txt s3
Client: Fetching '/random-text3.txt' from bambooshark.ics.cs.cmu.edu:20681
>fetch f6 random-binary3.bin s2
Client: Fetching '/random-binary3.bin' from bambooshark.ics.cs.cmu.edu:14183
>fetch f7 nothing2.txt s1
Client: Fetching '/nothing2.txt' from bambooshark.ics.cs.cmu.edu:9385
>fetch f8 nothing2.txt s2
Client: Fetching '/nothing2.txt' from bambooshark.ics.cs.cmu.edu:14183
>fetch f9 nothing2.txt s3
Client: Fetching '/nothing2.txt' from bambooshark.ics.cs.cmu.edu:20681
>wait *
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-text1.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:9385
Proxy stderr: Request-ID: f1
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-binary2.bin HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:14183
Proxy stderr: Request-ID: f2
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-text2.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:9385
Proxy stderr: Request-ID: f3
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-text3.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:20681
Proxy stderr: Request-ID: f5
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-binary2.bin HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:20681
Proxy stderr: Request-ID: f4
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: large_flag: 0, size: 10175
Proxy stderr: zyzyz: -1
Proxy stderr: GET /nothing2.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:14183
Proxy stderr: Request-ID: f8
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /nothing2.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:9385
Proxy stderr: Request-ID: f7
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: zyzyz: -1
Proxy stderr: GET /random-binary3.bin HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:14183
Proxy stderr: Request-ID: f6
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: left_size: 1038401
Proxy stderr: zyzyz: -1
Proxy stderr: GET /nothing2.txt HTTP/1.0
Proxy stderr: Host: bambooshark.ics.cs.cmu.edu:20681
Proxy stderr: Request-ID: f9
Proxy stderr: Response: Immediate
Proxy stderr: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:3.10.0) Gecko/20191101 Firefox/63.0.1
Proxy stderr: Connection: close
Proxy stderr: Proxy-Connection: close
Proxy stderr: 
Proxy stderr: large_flag: 0, size: 330
Proxy stderr: left_size: 1038071
Proxy stderr: large_flag: 0, size: 330
Proxy stderr: left_size: 1037741
Proxy stderr: large_flag: 0, size: 330
Proxy stderr: left_size: 1037411
Proxy stderr: large_flag: 0, size: 100192
Proxy stderr: left_size: 937219
Proxy stderr: large_flag: 0, size: 100176
Proxy stderr: left_size: 837043
Proxy stderr: large_flag: 0, size: 100192
Proxy stderr: left_size: 736851
Proxy stderr: large_flag: 1, size: 98304
Proxy stderr: large_flag: 1, size: 98304
>respond r5 r6 r7 r8 r9
Server responded to request r5 with status ok
Server responded to request r6 with status ok
Server responded to request r7 with status not_found (File 'nothing1.txt' not found)
Server responded to request r8 with status not_found (File 'nothing1.txt' not found)
Server responded to request r9 with status not_found (File 'nothing1.txt' not found)
>respond r1 r2 r3 r4 
Server responded to request r1 with status ok
Server responded to request r2 with status ok
Server responded to request r3 with status ok
Server responded to request r4 with status ok
>wait *
Proxy stderr: large_flag: 0, size: 330
Proxy stderr: left_size: 736521
Proxy stderr: large_flag: 0, size: 330
Proxy stderr: left_size: 736191
Proxy stderr: large_flag: 0, size: 330
Proxy stderr: left_size: 735861
Proxy stderr: large_flag: 0, size: 10175
Proxy stderr: left_size: 735861
Proxy stderr: large_flag: 0, size: 100176
Proxy stderr: left_size: 735861
Proxy stderr: large_flag: 0, size: 100192
Proxy stderr: large_flag: 0, size: 100192
Proxy stderr: left_size: 735861
Proxy stderr: left_size: 735861
Proxy stderr: large_flag: 1, size: 98304
Proxy stderr: large_flag: 1, size: 98304
>check r1
Request r1 yielded expected status 'ok'
>check r2
Request r2 yielded expected status 'ok'
>check r3
Request r3 yielded expected status 'ok'
>check r4
Request r4 yielded expected status 'ok'
>check r5
Request r5 yielded expected status 'ok'
>check r6
Request r6 yielded expected status 'ok'
>check r7 404
Request r7 yielded expected status 'not_found'
>check r8 404
Request r8 yielded expected status 'not_found'
>check r9 404
Request r9 yielded expected status 'not_found'
>check f1
Request f1 yielded expected status 'ok'
>check f2
Request f2 yielded expected status 'ok'
>check f3
Request f3 yielded expected status 'ok'
>check f4
Request f4 yielded expected status 'ok'
>check f5
Request f5 yielded expected status 'ok'
>check f6
Request f6 yielded expected status 'ok'
>check f7 404
Request f7 yielded expected status 'not_found'
>check f8 404
Request f8 yielded expected status 'not_found'
>check f9 404
Request f9 yielded expected status 'not_found'
>delete random-text1.txt
>delete random-binary1.bin
>delete random-text2.txt
>delete random-binary2.bin
>delete random-text3.txt
>delete random-binary3.bin
>quit
Testing done.  Elapsed time = 6.15 seconds
ALL TESTS PASSED
